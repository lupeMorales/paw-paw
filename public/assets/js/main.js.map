{"version":3,"sources":["game.js","main.js","maps.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9VA;AACA;AACA;AACA;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["\"use strict\";\n\nconst canvas = document.querySelector(\".js-canvas\");\nconst game = canvas.getContext(\"2d\");\n\nconst btnUp = document.querySelector(\".item-up\");\nconst btnDown = document.querySelector(\".item-down\");\nconst btnRight = document.querySelector(\".item-right\");\nconst btnLeft = document.querySelector(\".item-left\");\n\nconst life = document.querySelector(\".js-life\");\nconst timer = document.querySelector(\".js-timer\");\nconst record = document.querySelector(\".js-record\");\nconst result = document.querySelector(\".js-result\");\n\nconst btnCloseModal = document.querySelector(\".js-btn-close\");\nconst modal = document.querySelector(\".js-modal\");\nconst modalWinner = document.querySelector(\".js-modal-winner\");\nconst modalBlock = document.querySelector(\".js-modal-block\");\nconst btnYes = document.querySelectorAll(\".js-yes\");\nconst btnNo = document.querySelectorAll(\".js-no\");\n\nif (btnYes instanceof NodeList) {\n  console.log(\"ok\");\n}\nlet actualMapLevel;\n\nlet canvasSize;\nlet elementSize;\n\nlet level = 0;\nlet totalLifes = 3;\n\nlet timeStart;\nlet timeInterval;\nconst recordTime = localStorage.getItem(\"record_time\");\n\nconst messages = {\n  levelUp: \"Well done!\",\n  gameOver: \"GAME OVER!\",\n  gameWin: \"You Win!!! üèÜ\",\n};\n\nconst playerPosition = {\n  x: undefined,\n  y: undefined,\n};\n\nconst lastPlayerPosition = {\n  x: undefined,\n  y: undefined,\n};\n\nconst bonePosition = {\n  x: undefined,\n  y: undefined,\n};\n\nlet collisionPositions = [];\n\nlet isWithinTheMargin = true;\n\n// SET SIZE\nfunction setCanvasSize() {\n  //game screen size\n  if (window.innerHeight > window.innerWidth) {\n    canvasSize = Math.floor(window.innerWidth * 0.7);\n  } else {\n    canvasSize = Math.floor(window.innerHeight * 0.7);\n  }\n\n  canvas.setAttribute(\"width\", canvasSize);\n  canvas.setAttribute(\"height\", canvasSize);\n\n  //elements size\n  elementSize = Math.floor(canvasSize / 10 - 0.4);\n  game.font = elementSize + \"px Verdana\";\n  game.textAlign = \"end\";\n  // each time load screen or resize screen playerPositio(0,0):\n  // So, playerPosition updatesupdates at the same time that canvas and element are resized\n  // OJO CUIDAO!! when resized player back to the home\n  playerPosition.x = undefined;\n  playerPosition.y = undefined;\n  startGame();\n}\n\n// RENDER\n\nfunction renderLifes() {\n  //built am array with n items ( the numbers of item is totalLife)\n  const hearts = Array(totalLifes).fill(emojis[\"HEART\"]);\n  life.innerHTML = \"\";\n  hearts.forEach((item) => (life.innerHTML += item));\n}\n\nfunction showTime() {\n  timer.innerHTML = Date.now() - timeStart;\n}\n\nfunction showRecord() {\n  record.innerHTML = recordTime;\n}\nfunction renderMapLevel(level) {\n  const mapLevel = maps[level].trim().split(\"\\n\");\n  // this is a bidimensional array\n  actualMapLevel = mapLevel.map((row) => row.trim().split(\"\"));\n\n  collisionPositions = [];\n  clearCanvas();\n\n  renderLifes();\n  result.innerHTML = `Level ${level}/${maps.length}`;\n  if (!timeStart) {\n    timeStart = Date.now();\n    timeInterval = setInterval(showTime, 100);\n    showRecord();\n  }\n\n  actualMapLevel.forEach((row, indexRow) => {\n    row.forEach((column, indexColumn) => {\n      const emoji = emojis[column];\n      const positionX = elementSize * (indexColumn + 1);\n      const positionY = elementSize * (indexRow + 1);\n\n      //get player position\n      if (column == \"O\") {\n        if (!playerPosition.x && !playerPosition.y) {\n          playerPosition.x = positionX;\n          playerPosition.y = positionY;\n        }\n      } else if (column == \"I\") {\n        bonePosition.x = positionX;\n        bonePosition.y = positionY;\n      } else if (column == \"X\") {\n        collisionPositions.push({ x: positionX, y: positionY });\n      }\n      game.fillText(emoji, positionX, positionY);\n    });\n  });\n  renderPlayerPosition();\n\n  /*  game.fillText(emojis[\"PLAYER\"], playerPosition.x, playerPosition.y); */\n  /*   for (let i = 1; i <= 10; i++) {\n    for (let j = 1; j <= 10; j++) {\n      game.fillText(\n        emojis[actualMapLevel[j - 1][i - 1]],\n        elementSize * i,\n        elementSize * j\n      );\n    }\n  } */\n}\nfunction renderPlayerPosition() {\n  game.fillText(emojis[\"PLAYER\"], playerPosition.x, playerPosition.y);\n  validateCollisions();\n  getTheBone();\n}\nfunction clearCanvas() {\n  game.clearRect(0, 0, canvasSize, canvasSize);\n}\nfunction renderMessage(message) {\n  game.font = elementSize + \"px Cherry Bomb One\";\n  game.fontWeight = \"bold\";\n  game.fillStyle = \"#c27434\";\n  game.textAlign = \"center\";\n  game.fillText(message, canvasSize / 2, canvasSize / 2);\n}\n\nfunction exit() {\n  modal.classList.remove(\"active\");\n  modalWinner.classList.remove(\"active\");\n  modalBlock.classList.add(\"active\");\n}\n\n// MOVEMENT CONTROLS\nfunction moveUp() {\n  playerPosition.y -= elementSize;\n  if (withinTheMargin()) {\n    startGame();\n  } else {\n    playerPosition.y += elementSize;\n  }\n}\nfunction moveDown() {\n  playerPosition.y += elementSize;\n  if (withinTheMargin()) {\n    startGame();\n  } else {\n    playerPosition.y -= elementSize;\n  }\n}\nfunction moveLeft() {\n  playerPosition.x -= elementSize;\n  if (withinTheMargin()) {\n    startGame();\n  } else {\n    playerPosition.x += elementSize;\n  }\n}\nfunction moveRight() {\n  playerPosition.x += elementSize;\n  if (withinTheMargin()) {\n    startGame();\n  } else {\n    playerPosition.x -= elementSize;\n  }\n}\nfunction moveByKeys(ev) {\n  if (ev.key == \"ArrowUp\") moveUp();\n  else if (ev.key == \"ArrowDown\") moveDown();\n  else if (ev.key == \"ArrowLeft\") moveLeft();\n  else if (ev.key == \"ArrowRight\") moveRight();\n}\n\n//VALIDATIONS\n\nfunction validateCollisions() {\n  const collision = collisionPositions.find((enemy) => {\n    const collisionX = enemy.x.toFixed(3) == playerPosition.x.toFixed(3);\n    const collisionY = enemy.y.toFixed(3) == playerPosition.y.toFixed(3);\n    return collisionX && collisionY;\n  });\n\n  if (collision) {\n    game.fillText(emojis[\"BOMB_COLLISION\"], playerPosition.x, playerPosition.y);\n    totalLifes > 0 ? crashOver() : gameOver();\n  }\n}\n\nfunction getTheBone() {\n  if (JSON.stringify(bonePosition) === JSON.stringify(playerPosition)) {\n    validateLastLevel(level);\n  }\n}\nfunction withinTheMargin() {\n  if (\n    playerPosition.x >= elementSize &&\n    playerPosition.x <= canvasSize &&\n    playerPosition.y >= elementSize &&\n    playerPosition.y <= canvasSize\n  ) {\n    return true;\n  }\n}\nfunction validateLastLevel(actualLevel) {\n  actualLevel < maps.length - 1 ? levelUp() : winGame();\n}\n\nfunction crashOver() {\n  loseLife();\n  playerPosition.x = undefined;\n  playerPosition.y = undefined;\n\n  setTimeout(startGame, 1000);\n}\n\nfunction reset() {\n  playerPosition.x = undefined;\n  playerPosition.y = undefined;\n  level = 0;\n  totalLifes = [\"‚ù§Ô∏è\", \"‚ù§Ô∏è\", \"‚ù§Ô∏è\"];\n}\nfunction loseLife() {\n  totalLifes--;\n  renderLifes();\n}\nfunction startGame() {\n  renderMapLevel(level);\n}\nfunction gameOver() {\n  clearCanvas();\n  renderMessage(messages.gameOver);\n  clearInterval(timeInterval);\n\n  setTimeout(modal.classList.add(\"active\"), 1000);\n}\nfunction levelUp() {\n  level++;\n  clearCanvas();\n  result.innerHTML = `Level ${level}/${maps.length}`;\n  renderMessage(messages.levelUp);\n  setTimeout(setCanvasSize, 1000);\n}\nfunction winGame() {\n  const playerTime = Date.now() - timeStart;\n\n  clearInterval(timeInterval);\n  const cheer = () => {\n    clearCanvas();\n    for (let i = 1; i <= 10; i++) {\n      for (let j = 1; j <= 10; j++) {\n        game.fillText(emojis[\"I\"], elementSize * i, elementSize * j);\n      }\n    }\n    renderMessage(messages.gameWin);\n    function confetti() {\n      const jsConfetti = new JSConfetti();\n      jsConfetti.addConfetti({\n        emojis: [\"ü¶¥\", \"üê∂\", \"‚ú®\", \"üèÜ\"],\n        confettiRadius: 6,\n        confettiNumber: 50,\n      });\n    }\n    setInterval(confetti, 1000);\n    const showModal = modalWinner.classList.add(\"active\");\n    setTimeout(showModal, 5000);\n  };\n\n  if (!recordTime) {\n    localStorage.setItem(\"record_time\", playerTime);\n    result.innerHTML = \"Congratulations! You have broken a NEW RECORD\";\n    cheer();\n  } else {\n    if (recordTime >= playerTime) {\n      localStorage.setItem(\"record_time\", playerTime);\n      result.innerHTML = \"Congratulations! You have broken a NEW RECORD\";\n      cheer();\n    } else {\n      result.innerHTML = \"Sorry! NOT new record\";\n      cheer();\n    }\n  }\n}\n\nfunction reload() {\n  console.log(\"NO MISIELA\");\n}\n// events\n\nwindow.addEventListener(\"load\", setCanvasSize);\nwindow.addEventListener(\"resize\", setCanvasSize);\nwindow.addEventListener(\"keydown\", moveByKeys);\n\nbtnUp.addEventListener(\"click\", moveUp);\nbtnDown.addEventListener(\"click\", moveDown);\nbtnRight.addEventListener(\"click\", moveRight);\nbtnLeft.addEventListener(\"click\", moveLeft);\n\nbtnYes.forEach((item) => item.addEventListener(\"click\", reload));\nbtnNo.forEach((item) => item.addEventListener(\"click\", exit));\n\n// When the user clicks anywhere outside of the modal, close it\nwindow.onclick = function (event) {\n  if (event.target == modal) {\n    modal.style.display = \"none\";\n    modalBlock.style.display = \"block\";\n  } else if (event.target == modalWinner) {\n    modalWinner.style.display = \"none\";\n  }\n};\n","'use strict';\n\nconsole.log('>> Ready :)');\n","\"use strict\";\nconst emojis = {\n  \"-\": \" \",\n  O: \"üè†\",\n  X: \"üå≥\",\n  I: \"ü¶¥\",\n  PLAYER: \"üê∂\",\n  BOMB_COLLISION: \"üí•\",\n  GAME_OVER: \"üëé\",\n  WIN: \"üèÜ\",\n  HEART: \"‚ù§Ô∏è\",\n};\nconst maps = [];\nmaps.push(`\n    IXXXXXXXXX\n    -XXXXXXXXX\n    -XXXXXXXXX\n    -XXXXXXXXX\n    -XXXXXXXXX\n    -XXXXXXXXX\n    -XXXXXXXXX\n    -XXXXXXXXX\n    -XXXXXXXXX\n    OXXXXXXXXX\n  `);\nmaps.push(`\n    O--XXXXXXX\n    X--XXXXXXX\n    XX----XXXX\n    X--XX-XXXX\n    X-XXX--XXX\n    X-XXXX-XXX\n    XX--XX--XX\n    XX--XXX-XX\n    XXXX---IXX\n    XXXXXXXXXX\n    `);\n/* maps.push(`\n    I-----XXXX\n    XXXXX-XXXX\n    XX----XXXX\n    XX-XXXXXXX\n    XX-----XXX\n    XXXXXX-XXX\n    XX-----XXX\n    XX-XXXXXXX\n    XX-----OXX\n    XXXXXXXXXX\n  `);\nmaps.push(`\n  O---XXXXXX\n  XXX-XXXXXX\n  XXX-XXXXIX\n  XXX-XXXX-X\n  XXX---XX-X\n  XX--X-XX-X\n  XX--X-XX-X\n  XX--XXXX-X\n  XX-------X\n  XXXXXXXXXX\n`); */\n"]}